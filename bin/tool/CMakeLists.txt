add_executable(generate_node_address generate_node_address.cpp)
target_link_libraries(generate_node_address ${DFL_LINKER_LIBS})

add_executable(print_rocksdb print_rocksdb.cpp)
target_link_libraries(print_rocksdb ${DFL_LINKER_LIBS})

add_executable(block_db_to_json block_db_to_json.cpp)
target_link_libraries(block_db_to_json ${DFL_LINKER_LIBS})

add_executable(dirichlet_distribution_config_generator dirichlet_distribution_config_generator.cpp)
target_link_libraries(dirichlet_distribution_config_generator ${DFL_LINKER_LIBS})

add_executable(large_scale_simulation_generator large_scale_simulation_generator.cpp)
target_link_libraries(large_scale_simulation_generator ${DFL_LINKER_LIBS})

add_executable(large_scale_simulation_generator_social_network large_scale_simulation_generator_social_network.cpp)
target_link_libraries(large_scale_simulation_generator_social_network ${DFL_LINKER_LIBS})

add_executable(inject_interval_generator inject_interval_generator.cpp)
target_link_libraries(inject_interval_generator ${DFL_LINKER_LIBS})

# find CUDA
include(CheckLanguage)
check_language(CUDA)
set(ANALYZE_MODEL_SRC)
set(ANALYZE_MODEL_LINK)
if (CMAKE_CUDA_COMPILER)
    message(STATUS "build analyze_models with CUDA")
    add_compile_definitions(ANALYZE_MODEL_USE_CUDA=1)
    option(ANALYZE_MODEL_USE_SINGLE_CUDA_STREAM "only use the default CUDA stream" OFF)
    if (ANALYZE_MODEL_USE_SINGLE_CUDA_STREAM)
        add_compile_definitions(ANALYZE_MODEL_USE_SINGLE_CUDA_STREAM=1)
    else ()
        add_compile_definitions(ANALYZE_MODEL_USE_SINGLE_CUDA_STREAM=0)
    endif ()
    set(CMAKE_CUDA_ARCHITECTURES 52)
    enable_language(CUDA)
    list(APPEND ANALYZE_MODEL_SRC analyze_models.cu)
    list(APPEND ANALYZE_MODEL_LINK ${CUDA_LIBRARIES})
else ()
    message(STATUS "build analyze_models without CUDA")
    add_compile_definitions(ANALYZE_MODEL_USE_CUDA=0)
endif ()
list(APPEND ANALYZE_MODEL_SRC analyze_models.cpp)
add_executable(analyze_models ${ANALYZE_MODEL_SRC})
target_link_libraries(analyze_models ${DFL_LINKER_LIBS} ${ANALYZE_MODEL_LINK})
if (CMAKE_CUDA_COMPILER)
    target_compile_options(analyze_models PRIVATE $<$<COMPILE_LANGUAGE:CUDA>: --generate-line-info --use_fast_math -O3>)
endif ()
